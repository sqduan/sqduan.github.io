<!DOCTYPE html>












  


<html class="theme-next mist use-motion" lang="en,zh-CN,default">
<head><meta name="generator" content="Hexo 3.9.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">

<link rel="stylesheet" href="/css/main.css?v=7.1.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.2">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/feather.png?v=7.1.2">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.1.2">


  <link rel="mask-icon" href="/images/logo.svg?v=7.1.2" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '7.1.2',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="AbstractSome reading notes about state-space, and feedback and estimators in state space method basically from chapter 8 of $\textit{Linear system theory and design}$ 1.">
<meta name="keywords" content="Important">
<meta property="og:type" content="article">
<meta property="og:title" content="State-space, feedback and estimators">
<meta property="og:url" content="http://sqduan.github.io/2024/10/13/控制科学/控制理论/State-space_feedback_and_estimators/index.html">
<meta property="og:site_name" content="一隅">
<meta property="og:description" content="AbstractSome reading notes about state-space, and feedback and estimators in state space method basically from chapter 8 of $\textit{Linear system theory and design}$ 1.">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://raw.githubusercontent.com/sqduan/hexoimg/master/State-Space-Block-Dgrm.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/sqduan/hexoimg/master/Closed-loop-system-with-full-state-feedback.png">
<meta property="og:image" content="https://raw.githubusercontent.com/sqduan/hexoimg/master/observer.png">
<meta property="og:image" content="https://raw.githubusercontent.com/sqduan/hexoimg/master/observer_statefeedback_pend.png">
<meta property="og:image" content="https://raw.githubusercontent.com/sqduan/hexoimg/master/configuration.png">
<meta property="og:image" content="https://raw.githubusercontent.com/sqduan/hexoimg/master/%E6%89%B9%E6%B3%A8%202019-11-13%20111223.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/sqduan/hexoimg/master/planet%20of%20pandulum.png">
<meta property="og:image" content="https://raw.githubusercontent.com/sqduan/hexoimg/master/zeroinputtoplant.png">
<meta property="og:image" content="https://raw.githubusercontent.com/sqduan/hexoimg/master/%E6%89%B9%E6%B3%A8%202019-11-13%20114541.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/sqduan/hexoimg/master/controller.png">
<meta property="og:image" content="https://raw.githubusercontent.com/sqduan/hexoimg/master/%E6%89%B9%E6%B3%A8%202019-11-13%20153846.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/sqduan/hexoimg/master/%E6%89%B9%E6%B3%A8%202019-11-13%20153603.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/sqduan/hexoimg/master/%E6%89%B9%E6%B3%A8%202019-11-13%20153625.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/sqduan/hexoimg/master/%E6%89%B9%E6%B3%A8%202019-11-13%20165918.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/sqduan/hexoimg/master/%E6%89%B9%E6%B3%A8%202019-11-13%20170144.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/sqduan/hexoimg/master/%E6%89%B9%E6%B3%A8%202019-11-13%20172559.jpg">
<meta property="og:updated_time" content="2024-10-13T01:59:46.493Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="State-space, feedback and estimators">
<meta name="twitter:description" content="AbstractSome reading notes about state-space, and feedback and estimators in state space method basically from chapter 8 of $\textit{Linear system theory and design}$ 1.">
<meta name="twitter:image" content="https://raw.githubusercontent.com/sqduan/hexoimg/master/State-Space-Block-Dgrm.jpg">



  <link rel="alternate" href="/atom.xml" title="一隅" type="application/atom+xml">



  
  
  <link rel="canonical" href="http://sqduan.github.io/2024/10/13/控制科学/控制理论/State-space_feedback_and_estimators/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>State-space, feedback and estimators | 一隅</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">一隅</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">记录生活</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>About</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>Categories</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>Search</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="Searching..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://sqduan.github.io/2024/10/13/控制科学/控制理论/State-space_feedback_and_estimators/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Shiqi Duan">
      <meta itemprop="description" content="Do Not Go Gentle Into That Good Night">
      <meta itemprop="image" content="/images/header.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一隅">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">State-space, feedback and estimators

              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2024-10-13 09:59:46" itemprop="dateCreated datePublished" datetime="2024-10-13T09:59:46+08:00">2024-10-13</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/控制科学/" itemprop="url" rel="index"><span itemprop="name">控制科学</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/控制科学/控制理论/" itemprop="url" rel="index"><span itemprop="name">控制理论</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/控制科学/控制理论/现代控制/" itemprop="url" rel="index"><span itemprop="name">现代控制</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h2><p>Some reading notes about state-space, and feedback and estimators in state space method basically from chapter 8 of $\textit{Linear system theory and design}$ <sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>.</p>
<a id="more"></a>
<h2 id="State-space"><a href="#State-space" class="headerlink" title="State-space"></a>State-space</h2><h3 id="What-is-a-state-space-model"><a href="#What-is-a-state-space-model" class="headerlink" title="What is a state-space model?"></a>What is a state-space model?</h3><p>A state-space model, according to reference 2<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>, <strong>is a model uses  state variables to describe a system by a set of first-order differential or difference equations, rather than  by one or more nth-order differential or difference equations</strong>. In state-space models, we reconstruct state variables from input-output data rather than measure them directly.</p>
<p>Here’s the mathematical form and block diagram of SS model.</p>
<script type="math/tex; mode=display">
\begin{aligned}
\label{equ1}
\dot x(t)&=Ax(t)+Bu(t)+
\tilde K
w(t)\\
y(t)&=Cx(t)+Du(t)+w(t)\\
x(0)&=x0
\end{aligned}</script><p><img src="https://raw.githubusercontent.com/sqduan/hexoimg/master/State-Space-Block-Dgrm.jpg" width="500" alt="图片名称" align="center"></p>
<h3 id="Why-we-need-state-space-model"><a href="#Why-we-need-state-space-model" class="headerlink" title="Why we need state-space model"></a>Why we need state-space model</h3><ul>
<li>Can be used for Linear and nonlinear systems. </li>
<li>For both SISO and MIMO systems.</li>
<li>First order ODE’s means perfect for analysis </li>
<li>working in time domain</li>
</ul>
<h3 id="State-space-and-transfer-functions-conversion"><a href="#State-space-and-transfer-functions-conversion" class="headerlink" title="State-space and transfer functions: conversion"></a>State-space and transfer functions: conversion</h3><h4 id="SS-to-TF"><a href="#SS-to-TF" class="headerlink" title="SS to TF"></a>SS to TF</h4><script type="math/tex; mode=display">
\begin{aligned}
\dot x(t)&=Ax(t)+Bu(t)\\
y(t)&=Cx(t)+Du(t)\\
x(0)&=\textbf 0
\end{aligned}</script><ul>
<li>Laplace transfer</li>
</ul>
<script type="math/tex; mode=display">
\begin{aligned}
sX(s)&=AX(s)+BU(s)\\
Y(s)&=CX(s)+DU(s)\\
\end{aligned}</script><ul>
<li>Shift Item</li>
</ul>
<script type="math/tex; mode=display">
H(s)=\frac{Y(s)}{U(s)}=C\Phi(s)B+D=C(sI-A)^{-1}B+D</script><p>In Matlab (God I really like Matlab)</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[n,d]=ss2tf(A,B,C,D)</span><br></pre></td></tr></table></figure>
<h4 id="TF-to-SS"><a href="#TF-to-SS" class="headerlink" title="TF to SS"></a>TF to SS</h4><script type="math/tex; mode=display">
H(s)=\frac{Y(s)}{U(s)}=\frac{b_0}{s^n+a_1s^{n-1}+\cdots +a_{n-1}s+a_n}</script><ul>
<li>Shift Item and create  differential equation</li>
</ul>
<script type="math/tex; mode=display">
y^{(n)}+a_1y^{(n-1)}+\cdots+a_{n-1}\dot y+a_ny=u</script><ul>
<li>Choose state variables</li>
</ul>
<script type="math/tex; mode=display">
\begin{bmatrix}
x_1=y\\ 
x_2=\dot y\\ 
\vdots \\ 
x_n=y^{(n-1)}

\end{bmatrix}\rightarrow \begin{bmatrix}
\dot x_1=\dot y\\ 
\dot x_2=\ddot y\\ 
\vdots \\ 
\dot x_n =y^{(n)}

\end{bmatrix}</script><ul>
<li>Write as ss form</li>
</ul>
<h2 id="State-Feedback"><a href="#State-Feedback" class="headerlink" title="State Feedback"></a>State Feedback</h2><p><a id="State Feedback"></a></p>
<h3 id="What-is-state-feedback"><a href="#What-is-state-feedback" class="headerlink" title="What is state feedback"></a>What is state feedback</h3><p>Consider a simple open loop SISO ss euqation:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\dot x(t)&=\textbf Ax(t)+\textbf bu(t)\\
y(t)&=\textbf Cx(t)\\
\end{aligned}</script><p>We want use $u(t)$ to change system dynamics, so we introduce linear state feedback with gain $\textbf k$:</p>
<p><img src="https://raw.githubusercontent.com/sqduan/hexoimg/master/Closed-loop-system-with-full-state-feedback.png" width="500" alt="图片名称" align="center"></p>
<p>Now the input u is given by $u(t)=r(t)-\textbf kx(t)$ and our ss equation becomes:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\dot x(t)&=(\textbf A-\textbf {bk})x(t)+\textbf bu(t)\\
y(t)&=\textbf Cx(t)\\
\end{aligned}</script><h3 id="Why-we-need-state-feedback"><a href="#Why-we-need-state-feedback" class="headerlink" title="Why we need state feedback"></a>Why we need state feedback</h3><p>From the equations above we replace $\textbf A$ with $\textbf{A-bk}$, we know that $\textbf A$’s eigenvalues give the open-loop system poles, <strong>by selecting proper $\textbf K$, we can place the eigenvalues in any positions we what</strong>. </p>
<ul>
<li>$\mathscr{Theorem}\ 1$</li>
</ul>
<p>If n-dimensional ss equation is controllable, the eigenvalues of $\textbf{A-bk}$ can be arbitrarily assigned.</p>
<h3 id="How-do-we-design-a-proper-state-feedback"><a href="#How-do-we-design-a-proper-state-feedback" class="headerlink" title="How do we design a proper state feedback"></a>How do we design a proper state feedback</h3><h4 id="Method-1-According-to-desired-pole-placement"><a href="#Method-1-According-to-desired-pole-placement" class="headerlink" title="Method 1: According to desired pole placement"></a>Method 1: According to desired pole placement</h4><p>To apply pole placement method, first we need to clear how the pole influence the system, please refer to another article:  </p>
<p>In Matlab, we give system parameters and desired eigenvalues, the <code>place</code> function will give out the feedback gains. (We choose desired eigenvalues through system performance)</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a=[<span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span>; <span class="number">0</span> <span class="number">0</span> <span class="number">-1</span> <span class="number">0</span>; <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span>;<span class="number">0</span> <span class="number">0</span> <span class="number">5</span> <span class="number">0</span>]</span><br><span class="line">b=[<span class="number">0</span>;<span class="number">1</span>;<span class="number">0</span>;<span class="number">-2</span>]</span><br><span class="line">p=[<span class="number">-1.5</span>+<span class="number">0.5</span><span class="built_in">j</span> <span class="number">-1.5</span><span class="number">-0.5</span><span class="built_in">j</span> <span class="number">-1</span>+<span class="built_in">j</span> <span class="number">-1</span>-<span class="built_in">j</span>]</span><br><span class="line">k = place(a,b,p)   <span class="comment">% Or use the acker function</span></span><br></pre></td></tr></table></figure>
<h4 id="Method-2-Solving-Lyapunov-Equation"><a href="#Method-2-Solving-Lyapunov-Equation" class="headerlink" title="Method 2: Solving Lyapunov Equation"></a>Method 2: Solving Lyapunov Equation</h4><p>Same question as above, we want a proper $\textbf k$. </p>
<ul>
<li>First, we need a matrix $\textbf F$ according to eigenvalues</li>
<li>Next we select an $1\times n$ vector $\bar {\textbf{k}}$ makes $(\textbf F,\bar {\textbf{k}})$ observable</li>
<li>Then we solve the unique $T$ in Lyapunov equation $\textbf{AT-TF=b}\bar {\textbf{k}}$</li>
<li>Finally we compute feedback gain $\textbf k=\bar {\textbf{k}}\textbf T^{-1}$</li>
</ul>
<p>Matlab codes</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a=[0 1 0 0; 0 0 -1 0; 0 0 0 1;0 0 5 0];</span><br><span class="line">b=[0;1;0;-2];</span><br><span class="line">f = [-1 1 0 0; -1 -1 0 0; 0 0 -1.5 0.5; 0 0 -0.5 -1.5];</span><br><span class="line">kb=[1 0 1 0];</span><br><span class="line">k=kb*inv(t)</span><br></pre></td></tr></table></figure>
<h4 id="Method-3-LQR-Method"><a href="#Method-3-LQR-Method" class="headerlink" title="Method 3: LQR Method"></a>Method 3: LQR Method</h4><p><a id="LQR Method"></a></p>
<p>The LQR method is an optimal control method which goal is to find the controller that minimizes a quadratic cost function subject to the linear system dynamics. It’s assumed that</p>
<ul>
<li>There is no noise</li>
<li>The full system is observerable</li>
</ul>
<p>The mathematical form of LQR is:</p>
<script type="math/tex; mode=display">
\begin{aligned}
&\min \limits_{u(\cdot )}\int_{0}^{T}(x^TQx+u^TRu)dt + x(T)^TQ_fx(T)\\

s.t.\ \ &\dot x=Ax+bu\\
&y=x\\
&x(0)-Given
\end{aligned}</script><p>The optimal controller for the LQR problem is a linear feedback controller with a form of </p>
<script type="math/tex; mode=display">
u(t)=\textbf Kx(t)</script><h2 id="State-Estimator"><a href="#State-Estimator" class="headerlink" title="State Estimator"></a>State Estimator</h2><p><a href="#State Estimator"></a></p>
<h3 id="What-is-a-state-estimator"><a href="#What-is-a-state-estimator" class="headerlink" title="What is a state estimator"></a>What is a state estimator</h3><p>A state estimator or observer is <strong>a device generates an estimate of the state</strong>. We hope that the output of the estimator is just the same as the behavior of the plant.</p>
<h4 id="Open-loop-state-estimator"><a href="#Open-loop-state-estimator" class="headerlink" title="Open loop state estimator"></a>Open loop state estimator</h4><h5 id="Basic-structure"><a href="#Basic-structure" class="headerlink" title="Basic structure"></a>Basic structure</h5><p>First let’s take a look at the open loop state estimator:</p>
<p><img src="https://raw.githubusercontent.com/sqduan/hexoimg/master/observer.png" width="400" alt="图片名称" align="center"></p>
<p>If we know $\textbf A $ and $\textbf b$, we can duplicate the system as:</p>
<script type="math/tex; mode=display">
\dot {\hat{x}}(t)=\textbf A\hat x(t)+\textbf bu(t)</script><p>The estimation error is $\tilde{x}(k)=A^{k}(x(0)-\hat{x}(0))$, this is not ideal because:</p>
<ul>
<li>The dynamics of the estimation error are fixed by the eigenvalues of A and cannot be modified</li>
<li>The estimation error vanishes asymptotically if and only if A is asymptotically stable<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup></li>
</ul>
<h5 id="Disadvantages"><a href="#Disadvantages" class="headerlink" title="Disadvantages:"></a>Disadvantages:</h5><ul>
<li>initial state must be computed and set each time we use estimator</li>
<li>There will be a difference between $x(t)$ and $\hat x(t)$ </li>
</ul>
<h4 id="Close-loop-state-estimator-Luenberger-observer"><a href="#Close-loop-state-estimator-Luenberger-observer" class="headerlink" title="Close loop state estimator (Luenberger observer)"></a>Close loop state estimator (Luenberger observer)</h4><p><img src="https://raw.githubusercontent.com/sqduan/hexoimg/master/observer_statefeedback_pend.png" width="300" alt="图片名称" align="center"></p>
<p>We modify the estimator in which the output $y(t)=c{\textbf x}(t)$ is compared with $c\hat{\textbf x}(t)$, the difference is used as a correlation term. If difference is zero, nothing to do. If the difference is nonzero and gain $\textbf l$ is proper designed, the difference will drive the estimated state to actual state.</p>
<script type="math/tex; mode=display">
\dot {\hat{\textbf x}}(t)=\textbf A\hat {\textbf x}(t)+\textbf bu(t)+\textbf l(y(t)-\textbf c\hat{\textbf x}(t))</script><p>Let’s define $\textbf e(t)$ is the evaluated error of state estimation</p>
<script type="math/tex; mode=display">
\begin{equation}
\begin{aligned}
\textbf e(t):&=\textbf x(t)-{\hat{\textbf x}}(t)\\
\dot{\textbf e}(t)&=\dot{\textbf x}(t)-\dot{\hat{\textbf x}}(t)\\
&=\textbf {Ax}(t)+\textbf bu(t)-\textbf A\hat {\textbf x}(t)-\textbf bu(t)-\textbf l(y(t)-\textbf c\hat{\textbf x}(t))\\
&=(\textbf A-\textbf l\textbf c)(\textbf x(t)-{\hat{\textbf x}}(t))\\
&=(\textbf A-\textbf l\textbf c)\textbf e(t)
\end{aligned}
\end{equation}
\label{etxtxh}</script><p>This is a first order difference function, by choosing a proper $L$, we can stabilize $(\textbf A-\textbf l\textbf c)$, the solution is an exponential function, thus the state error tends to zero with an exponential form, thus the estimation is unbiased.</p>
<p>From equation $\eqref{etxtxht}$ we can also notice that it doesn’t contain any control quantity, thus it is uncontrollable. However, as long as the system is stable, the estimation error tends to zero if the roots of the characteristic equation $\det(s\textbf I-\textbf A+\textbf l\textbf c)$ fall into the left half plane.</p>
<h5 id="Observer-design"><a href="#Observer-design" class="headerlink" title="Observer design"></a>Observer design</h5><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">x=[<span class="number">-1</span>;<span class="number">1</span>]; <span class="comment">% initial state</span></span><br><span class="line">xhat=[<span class="number">0</span>;<span class="number">0</span>]; <span class="comment">% initial estimate</span></span><br><span class="line"></span><br><span class="line">XX=x;</span><br><span class="line">XXhat=xhat;</span><br><span class="line">T=<span class="number">40</span>;</span><br><span class="line">UU=<span class="number">.1</span>*<span class="built_in">ones</span>(<span class="number">1</span>,T); <span class="comment">% input signal</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k=<span class="number">0</span>:T<span class="number">-1</span>,</span><br><span class="line">    u=UU(k+<span class="number">1</span>);</span><br><span class="line">    y=C*x+D*u;</span><br><span class="line">    yhat=C*xhat+D*u;</span><br><span class="line">    </span><br><span class="line">    x=A*x+B*u;</span><br><span class="line">    xhat=A*xhat+B*u+L*(y-yhat);</span><br><span class="line">    </span><br><span class="line">    XX=[XX,x];</span><br><span class="line">    XXhat=[XXhat,xhat];</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">plot</span>(<span class="number">0</span>:T,[XX(<span class="number">1</span>,:);XXhat(<span class="number">1</span>,:)]);</span><br></pre></td></tr></table></figure>
<h3 id="Why-we-need-a-state-estimator"><a href="#Why-we-need-a-state-estimator" class="headerlink" title="Why we need a state estimator"></a>Why we need a state estimator</h3><p>Ideally, the state variables are all available for feedback. In practice, some variables are not accessible. So we introduce observers to the system, for example, in self-driving, we have GPS, IMU, et al. as observers.</p>
<h3 id="How-to-design-a-state-estimator"><a href="#How-to-design-a-state-estimator" class="headerlink" title="How to design a state estimator"></a>How to design a state estimator</h3><p>The equation $\dot{ \textbf{e}}(t)=(\textbf A-\textbf l\textbf c)\textbf e(t)<br>$ governs the estimation error. If all eigenvalues of $(\textbf A-\textbf l\textbf c)$ can be arbitrarily assigned, we can control the rate for $\textbf e(t)$ to approach zero, so <strong>the feedback gain of $\textbf l$ help us to reduce the difference between actual state and observed state</strong>. Since we want the dynamics of the observer to be much faster than the system itself, we need to place the poles at least five times farther to the left than the dominant poles of the system. </p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p=[<span class="number">-1.5</span>+<span class="number">0.5</span><span class="built_in">j</span> <span class="number">-1.5</span><span class="number">-0.5</span><span class="built_in">j</span> <span class="number">-1</span>+<span class="built_in">j</span> <span class="number">-1</span>-<span class="built_in">j</span>]</span><br><span class="line">L = place(A',C',p*<span class="number">10</span>);</span><br></pre></td></tr></table></figure>
<h2 id="Feedback-from-estimated-states"><a href="#Feedback-from-estimated-states" class="headerlink" title="Feedback from estimated states"></a>Feedback from estimated states</h2><p>Now let’s combine the feedback with state estimator, our state variables are not available for feedback, so we design a state estimator to get the observed variables.</p>
<p><img src="https://raw.githubusercontent.com/sqduan/hexoimg/master/configuration.png" width="400" alt="图片名称" align="center"></p>
<p>It can be proved that the feedback and estimator are independent and can be carried out independently. This is called the <strong>separation property</strong>.</p>
<h2 id="Application-State-feedback-control-of-a-inverted-pendulum-system"><a href="#Application-State-feedback-control-of-a-inverted-pendulum-system" class="headerlink" title="Application: State feedback control of a inverted pendulum system"></a>Application: State feedback control of a inverted pendulum system</h2><p>This section is mainly based on a short tutorial from reference <sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup>. </p>
<h3 id="Problem-setting"><a href="#Problem-setting" class="headerlink" title="Problem setting"></a>Problem setting</h3><p>Suppose we have a Pendulum-Cart system to be controlled shown below</p>
<p><img src="https://raw.githubusercontent.com/sqduan/hexoimg/master/%E6%89%B9%E6%B3%A8%202019-11-13%20111223.jpg" width="250" alt="图片名称" align="center"></p>
<p>The overall objective will be broken down into the following tasks:</p>
<ul>
<li>Linear dynamic system modeling</li>
<li>System analysis</li>
<li>Controller designing in SS</li>
<li>State observer designing and investigating in close loop</li>
<li>Discretization  </li>
</ul>
<h3 id="Linear-dynamic-system-modeling"><a href="#Linear-dynamic-system-modeling" class="headerlink" title="Linear dynamic system modeling"></a>Linear dynamic system modeling</h3><p>We shall not focus too much on the modeling process, here we give out the linear model of inverted pendulum directly:</p>
<script type="math/tex; mode=display">
\begin{aligned}

\textbf{x} &=

\begin{pmatrix}
q_1\\ 
q_2\\ 
\dot q_1\\
\dot q_2
\end{pmatrix}
\\

\dot {\textbf{x}} &= \textbf A\textbf{x}+\textbf bu
\end{aligned}</script><p>Let $q_1$ (position) and $q2$ (angular) be the system output, $\textbf A$ and $\textbf b$ is:</p>
<script type="math/tex; mode=display">
\begin{aligned}

\textbf{A} =

\begin{pmatrix}
0& 0& 1 &0\\ 
0& 0& 0 &1\\ 
0 &\frac{gm_p}{m_c} & \frac{-d_1}{m_c} & \frac{-d_2}{Lm_c}\\
0 &\frac{g(m_c+m_p)}{Lm_c} & \frac{d_1}{Lm_c} &-\frac{d_2(m_c+m_p)}{L^2m_cm_p}
\end{pmatrix}


,\ \ \ \textbf{B} =

\begin{pmatrix}
0\\ 
0\\
\frac{1}{m_c}\\
\frac{1}{Lm_c}
\end{pmatrix}

\end{aligned}</script><p>where: $m_c = 1.5,m_p=0.5,g=9.82,L=1,d_1=d_2=0.01$.</p>
<div><div class="fold_hider"><div class="close hider_title">Unfold/Fold</div></div><div class="fold">
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">clc;</span><br><span class="line">clear;</span><br><span class="line">close all;</span><br><span class="line"></span><br><span class="line">mc = <span class="number">1.5</span>;</span><br><span class="line">mp = <span class="number">0.5</span>;</span><br><span class="line">g  = <span class="number">9.82</span>;</span><br><span class="line">L  = <span class="number">1</span>;</span><br><span class="line">d1 = <span class="number">1e-2</span>;</span><br><span class="line">d2 = <span class="number">1e-2</span>;</span><br><span class="line"></span><br><span class="line">A  = [<span class="number">0</span>,                   <span class="number">0</span>,          <span class="number">1</span>,                         <span class="number">0</span>;</span><br><span class="line">      <span class="number">0</span>,                   <span class="number">0</span>,          <span class="number">0</span>,                         <span class="number">1</span>;</span><br><span class="line">      <span class="number">0</span>,           (g*mp)/mc,     -d1/mc,                -d2/(L*mc);</span><br><span class="line">      <span class="number">0</span>,(g*(mc + mp))/(L*mc), -d1/(L*mc),-(d2*mc+d2*mp)/(L^<span class="number">2</span>*mc*mp)];</span><br><span class="line">B  = [<span class="number">0</span>; <span class="number">0</span> ; <span class="number">1</span>/mc; <span class="number">1</span>/(L*mc)];</span><br><span class="line"></span><br><span class="line">C   = [<span class="number">1</span>;<span class="number">0</span>;<span class="number">0</span>;<span class="number">0</span>];          <span class="comment">% Set q_1 as output</span></span><br><span class="line">D = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">x0 = [<span class="number">0</span>;<span class="number">5</span>*<span class="built_in">pi</span>/<span class="number">180</span>;<span class="number">0</span>;<span class="number">0</span>];    <span class="comment">% Initial state of the integrator</span></span><br></pre></td></tr></table></figure>

</div></div>
<p>And the plant in simulink is:</p>
<p><img src="https://raw.githubusercontent.com/sqduan/hexoimg/master/planet%20of%20pandulum.png" width="600" alt="图片名称" align="center"></p>
<h3 id="System-analysis"><a href="#System-analysis" class="headerlink" title="System analysis"></a>System analysis</h3><p>Given a zero input, the output of the system shows that it’s not stable:</p>
<p><img src="https://raw.githubusercontent.com/sqduan/hexoimg/master/zeroinputtoplant.png" width="400" alt="图片名称" align="center"></p>
<p><img src="https://raw.githubusercontent.com/sqduan/hexoimg/master/%E6%89%B9%E6%B3%A8%202019-11-13%20114541.jpg" width="400" alt="图片名称" align="center"></p>
<p>You can also refer to the eigenvalues, the root locus to see the stability of the system.</p>
<div><div class="fold_hider"><div class="close hider_title">Unfold/Fold</div></div><div class="fold">
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%% System stability</span></span><br><span class="line">eig_A = eig(A);      <span class="comment">% Eigenvalue of A</span></span><br><span class="line">pole_A =pole(sys);   <span class="comment">% Has a positive pole, not stable</span></span><br><span class="line"></span><br><span class="line">Sc = ctrb(sys);      <span class="comment">% Controllability</span></span><br><span class="line">So = obsv(sys);      <span class="comment">% Observability</span></span><br><span class="line">rank(Sc)             <span class="comment">% 4</span></span><br><span class="line">rank(So)             <span class="comment">% 4</span></span><br></pre></td></tr></table></figure>

</div></div>
<h3 id="Controller-designing-in-SS"><a href="#Controller-designing-in-SS" class="headerlink" title="Controller designing in SS"></a>Controller designing in SS</h3><p>First we give out the desire pole we want our system to be set (according to the performance of the system). Based on the desire pole, we can calculate the feedback gain $\textbf K$ (<a href="#State Feedback">Click here to review state feedback</a>).</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%% Controller</span></span><br><span class="line">des_pole = [<span class="number">-3</span>,<span class="number">-3</span>,<span class="number">-3</span>,<span class="number">-3</span>];</span><br><span class="line">K        = acker(A,B,des_pole);</span><br></pre></td></tr></table></figure>
<p>Or we can apply the LQR method to get the gain (<a href="#LQR Method">Click here to review LQR methood</a>).:</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Q        = <span class="built_in">eye</span>(<span class="number">4</span>);</span><br><span class="line">R        = <span class="number">1</span>;</span><br><span class="line">K_lqr    = lqr(A,B,Q,R);</span><br></pre></td></tr></table></figure>
<p>The controller and it’s inner structure is shown below</p>
<p><img src="https://raw.githubusercontent.com/sqduan/hexoimg/master/controller.png" width="400" alt="Controller with it's inner structure" align="center"></p>
<p>By adding the controller to the system, now we can apply a control behavior to the plant. Given a reference trajectory pulse, we can check the out put of the system. The control system, input and output trajectories and the simulation animation is shown below.</p>
<p><img src="https://raw.githubusercontent.com/sqduan/hexoimg/master/%E6%89%B9%E6%B3%A8%202019-11-13%20153846.jpg" width="300" alt="Controller with it's inner structure" align="center"></p>
<p><img src="https://raw.githubusercontent.com/sqduan/hexoimg/master/%E6%89%B9%E6%B3%A8%202019-11-13%20153603.jpg" width="300" alt="Controller with it's inner structure" align="center"></p>
<p><img src="https://raw.githubusercontent.com/sqduan/hexoimg/master/%E6%89%B9%E6%B3%A8%202019-11-13%20153625.jpg" width="300" alt="Controller with it's inner structure" align="center"></p>
<h3 id="State-observer-designing-and-investigating-in-close-loop"><a href="#State-observer-designing-and-investigating-in-close-loop" class="headerlink" title="State observer designing and investigating in close loop"></a>State observer designing and investigating in close loop</h3><p>So far so good, now let’s further introduce the observer to the system, <a href="#State Estimator">Click here to review the design process of a state estimator</a>.</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">L       = acker(A',C,des_pole*<span class="number">10</span>);</span><br></pre></td></tr></table></figure>
<p>The observer and it’s inner structure is shown below</p>
<p><img src="https://raw.githubusercontent.com/sqduan/hexoimg/master/%E6%89%B9%E6%B3%A8%202019-11-13%20165918.jpg" width="300" alt="Controller with it's inner structure" align="center"></p>
<p>And the output of the observer is quite like the original plant.</p>
<p><img src="https://raw.githubusercontent.com/sqduan/hexoimg/master/%E6%89%B9%E6%B3%A8%202019-11-13%20170144.jpg" width="300" alt="Controller with it's inner structure" align="center"></p>
<h3 id="Discretization"><a href="#Discretization" class="headerlink" title="Discretization"></a>Discretization</h3><p>The final step is to discrete the controller and observer. First we discrete the controller, then the observer.</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% discrete </span></span><br><span class="line">Ts = <span class="number">0.1</span>;</span><br><span class="line">sys_d = c2d(sys,Ts);</span><br><span class="line"></span><br><span class="line">Ad   = sys_d.a;</span><br><span class="line">Bd   = sys_d.b;</span><br><span class="line">Cd   = sys_d.c;</span><br><span class="line">Dd   = sys_d.d;</span><br><span class="line"></span><br><span class="line">des_pole_d = [<span class="number">0.3</span>; <span class="number">0.3</span>;<span class="number">0.3</span>;<span class="number">0.3</span>];  </span><br><span class="line">K_d = acker(Ad,Bd,des_pole_d);</span><br><span class="line"></span><br><span class="line">des_pole_d = [<span class="number">0.3</span>;<span class="number">0.3</span>;<span class="number">0.3</span>;<span class="number">0.3</span>]*<span class="number">0.1</span>;</span><br><span class="line">L_d  = acker(Ad',Cd',des_pole_d);</span><br></pre></td></tr></table></figure>
<p>Then replace the parameters in the system with discrete ones and add zero order holder, change integrator to unit delay model, we get our discrete control system.</p>
<p><img src="https://raw.githubusercontent.com/sqduan/hexoimg/master/%E6%89%B9%E6%B3%A8%202019-11-13%20172559.jpg" width="400" alt="Discrete control system of an inverted pendulum" align="center"></p>
<h2 id="reference"><a href="#reference" class="headerlink" title="reference"></a>reference</h2><div id="footnotes"><hr><div id="footnotelist"><ol><li id="fn:1"><a href="http://www.ebadi.profcms.um.ac.ir/imagesm/474/stories/modern_control/chen%20c%20-t%20linear%20system%20theory%20and%20design.pdf">Chen C T. Linear system theory and design[M]. Oxford University Press, Inc., 1998.</a><a href="#fnref:1" rev="footnote"> ↩</a></li><li id="fn:2"><a href="http://cse.lab.imtlucca.it/~bemporad/teaching/ac/pdf/06b-estimator.pdf">State estimation and linear observers</a><a href="#fnref:2" rev="footnote"> ↩</a></li><li id="fn:3"><a href="https://www.mathworks.com/help/control/ref/ss.html">Matlab documents about ss</a><a href="#fnref:3" rev="footnote"> ↩</a></li><li id="fn:4"><a href="https://www.youtube.com/watch?v=hAI8Ag3bzeE">State Space Control for the Pendulum-Cart System</a><a href="#fnref:4" rev="footnote"> ↩</a></li></ol></div></div>
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        
          
        
        <div class="post-tags">
          
            <a href="/tags/Important/" rel="tag"># Important</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2024/10/13/控制科学/控制理论/controllability_and_observability/" rel="next" title="Controllability and observability">
                <i class="fa fa-chevron-left"></i> Controllability and observability
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2024/10/13/控制科学/控制理论/PID_control_and_tuning/" rel="prev" title="PID control and tuning">
                PID control and tuning <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/header.jpg" alt="Shiqi Duan">
            
              <p class="site-author-name" itemprop="name">Shiqi Duan</p>
              <div class="site-description motion-element" itemprop="description">Do Not Go Gentle Into That Good Night</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">274</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">53</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                    <span class="site-state-item-count">1</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:sqduan@mail.ustc.edu.cn" title="E-Mail &rarr; mailto:sqduan@mail.ustc.edu.cn" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://gitlab.com/sqduan" title="GitLab &rarr; https://gitlab.com/sqduan" rel="noopener" target="_blank"><i class="fa fa-fw fa-gitlab"></i>GitLab</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://www.zhihu.com/people/duan-shi-qi-72/activities" title="知乎 &rarr; https://www.zhihu.com/people/duan-shi-qi-72/activities" rel="noopener" target="_blank"><i class="fa fa-fw fa-globe"></i>知乎</a>
                </span>
              
            </div>
          

          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                我的朋友们
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://mayi1996.top/" title="https://mayi1996.top/" rel="noopener" target="_blank">马亿</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://zhangchenyu.me/" title="https://zhangchenyu.me/" rel="noopener" target="_blank">张琛昱</a>
                  </li>
                
              </ul>
            </div>
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Abstract"><span class="nav-number">1.</span> <span class="nav-text">Abstract</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#State-space"><span class="nav-number">2.</span> <span class="nav-text">State-space</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#What-is-a-state-space-model"><span class="nav-number">2.1.</span> <span class="nav-text">What is a state-space model?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Why-we-need-state-space-model"><span class="nav-number">2.2.</span> <span class="nav-text">Why we need state-space model</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#State-space-and-transfer-functions-conversion"><span class="nav-number">2.3.</span> <span class="nav-text">State-space and transfer functions: conversion</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#SS-to-TF"><span class="nav-number">2.3.1.</span> <span class="nav-text">SS to TF</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#TF-to-SS"><span class="nav-number">2.3.2.</span> <span class="nav-text">TF to SS</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#State-Feedback"><span class="nav-number">3.</span> <span class="nav-text">State Feedback</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#What-is-state-feedback"><span class="nav-number">3.1.</span> <span class="nav-text">What is state feedback</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Why-we-need-state-feedback"><span class="nav-number">3.2.</span> <span class="nav-text">Why we need state feedback</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#How-do-we-design-a-proper-state-feedback"><span class="nav-number">3.3.</span> <span class="nav-text">How do we design a proper state feedback</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Method-1-According-to-desired-pole-placement"><span class="nav-number">3.3.1.</span> <span class="nav-text">Method 1: According to desired pole placement</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Method-2-Solving-Lyapunov-Equation"><span class="nav-number">3.3.2.</span> <span class="nav-text">Method 2: Solving Lyapunov Equation</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Method-3-LQR-Method"><span class="nav-number">3.3.3.</span> <span class="nav-text">Method 3: LQR Method</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#State-Estimator"><span class="nav-number">4.</span> <span class="nav-text">State Estimator</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#What-is-a-state-estimator"><span class="nav-number">4.1.</span> <span class="nav-text">What is a state estimator</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Open-loop-state-estimator"><span class="nav-number">4.1.1.</span> <span class="nav-text">Open loop state estimator</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Basic-structure"><span class="nav-number">4.1.1.1.</span> <span class="nav-text">Basic structure</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Disadvantages"><span class="nav-number">4.1.1.2.</span> <span class="nav-text">Disadvantages:</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Close-loop-state-estimator-Luenberger-observer"><span class="nav-number">4.1.2.</span> <span class="nav-text">Close loop state estimator (Luenberger observer)</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Observer-design"><span class="nav-number">4.1.2.1.</span> <span class="nav-text">Observer design</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Why-we-need-a-state-estimator"><span class="nav-number">4.2.</span> <span class="nav-text">Why we need a state estimator</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#How-to-design-a-state-estimator"><span class="nav-number">4.3.</span> <span class="nav-text">How to design a state estimator</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Feedback-from-estimated-states"><span class="nav-number">5.</span> <span class="nav-text">Feedback from estimated states</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Application-State-feedback-control-of-a-inverted-pendulum-system"><span class="nav-number">6.</span> <span class="nav-text">Application: State feedback control of a inverted pendulum system</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Problem-setting"><span class="nav-number">6.1.</span> <span class="nav-text">Problem setting</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Linear-dynamic-system-modeling"><span class="nav-number">6.2.</span> <span class="nav-text">Linear dynamic system modeling</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#System-analysis"><span class="nav-number">6.3.</span> <span class="nav-text">System analysis</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Controller-designing-in-SS"><span class="nav-number">6.4.</span> <span class="nav-text">Controller designing in SS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#State-observer-designing-and-investigating-in-close-loop"><span class="nav-number">6.5.</span> <span class="nav-text">State observer designing and investigating in close loop</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Discretization"><span class="nav-number">6.6.</span> <span class="nav-text">Discretization</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#reference"><span class="nav-number">7.</span> <span class="nav-text">reference</span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2025</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Shiqi Duan</span>

  

  
</div>






  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> v7.1.2</div>



    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    <span id="busuanzi_container_site_pv">|总访问量<span id="busuanzi_value_site_pv"></span>次</span>
    <span class="post-meta-divider">|</span>
    <span id="busuanzi_container_site_uv">总访客<span id="busuanzi_value_site_uv"></span>人</span>
    <span class="post-meta-divider">|</span>






  <script src="https://cdn.jsdelivr.net/npm/mermaid@7.1.2/dist/mermaid.min.js"></script>
  <script>
    if (window.mermaid) {
      mermaid.initialize("");
    }
  </script>

        






<div>
<!-- 填写你的友盟代码 -->
<script type="text/javascript">
	var cnzz_protocol = (("https:" == document.location.protocol) ? "https://" : "http://");
	document.write(unescape("%3Cspan id='cnzz_stat_icon_1278217259'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s9.cnzz.com/z_stat.php%3Fid%3D1278217259' type='text/javascript'%3E%3C/script%3E"));
</script>
<!-- 你的友盟代码 end -->
</div>


        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>














  
    
    
  
  <script color="66,73,73" opacity="0.7" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script>













  
  <script src="/lib/jquery/index.js?v=3.4.1"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.1.2"></script>

  <script src="/js/motion.js?v=7.1.2"></script>



  
  


  <script src="/js/schemes/muse.js?v=7.1.2"></script>




  
  <script src="/js/scrollspy.js?v=7.1.2"></script>
<script src="/js/post-details.js?v=7.1.2"></script>



  


  <script src="/js/next-boot.js?v=7.1.2"></script>


  

  

  

  


  


  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
  

  
  

  
    
      <script type="text/x-mathjax-config">
  

  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$', '$'], ['\\(', '\\)'] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      
      equationNumbers: {
        autoNumber: 'AMS'
      }
    }
  });
  MathJax.Hub.Register.StartupHook('TeX Jax Ready', function() {
    MathJax.InputJax.TeX.prefilterHooks.Add(function(data) {
      if (data.display) {
        var next = data.script.nextSibling;
        while (next && next.nodeName.toLowerCase() === '#text') { next = next.nextSibling }
        if (next && next.nodeName.toLowerCase() === 'br') { next.parentNode.removeChild(next) }
      }
    });
  });
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i = 0; i < all.length; i += 1) {
      document.getElementById(all[i].inputID + '-Frame').parentNode.className += ' has-jax';
    }
  });
</script>
<script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>


<script type="text/x-mathjax-config">
   MathJax.Hub.Config({
       TeX: {equationNumbers: {autoNumber: ["AMS"], useLabelIds: true}},
       "HTML-CSS": {linebreaks: {automatic: true}},
       SVG: {linebreaks: {automatic: true}}
   });
</script>
    
  


  
<script>
if ($('body').find('div.pdf').length) {
  $.ajax({
    type: 'GET',
    url: '//cdn.jsdelivr.net/npm/pdfobject@2/pdfobject.min.js',
    dataType: 'script',
    cache: true,
    success: function() {
      $('body').find('div.pdf').each(function(i, o) {
        PDFObject.embed($(o).attr('target'), $(o), {
          pdfOpenParams: {
            navpanes: 0,
            toolbar: 0,
            statusbar: 0,
            pagemode: 'thumbs',
            view: 'FitH'
          },
          PDFJS_URL: '/lib/pdf/web/viewer.html',
          height: $(o).attr('height') || '600px'
        });
      });
    },
  });
}
</script>


  
<script>
if ($('body').find('pre.mermaid').length) {
  $.ajax({
    type: 'GET',
    url: '//cdn.jsdelivr.net/npm/mermaid@7.1.2/dist/mermaid.min.js',
    dataType: 'script',
    cache: true,
    success: function() {
      mermaid.initialize({
        theme: 'forest',
        logLevel: 3,
        flowchart: { curve: 'linear' },
        gantt: { axisFormat: '%m/%d/%Y' },
        sequence: { actorMargin: 50 }
      });
    }
  });
}
</script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->


  

  

  

  

  

  

  

  

  

</body>
</html>
